{
    "AWSTemplateFormatVersion": "2010-09-09",
   "Resources":{
      "SecurityGroupWB":{
         "Type":"AWS::EC2::SecurityGroup",
         "Properties":{

            "GroupDescription":"SecurityGroup to access webapplication",
            "SecurityGroupIngress":[
               {
                  "CidrIp":"0.0.0.0/0",
                  "Description":"To allow world for port 80",
                  "FromPort":"80",
                  "ToPort":"80",
                  "IpProtocol":"TCP"
               },
               {
                  "CidrIp":"0.0.0.0/0",
                  "Description":"To allow world for port 22",
                  "FromPort":"22",
                  "ToPort":"22",
                  "IpProtocol":"TCP"
               },
               {
                  "CidrIp":"0.0.0.0/0",
                  "Description":"To allow world for port 443",
                  "FromPort":"8080",
                  "ToPort":"8080",
                  "IpProtocol":"TCP"
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":"SecurityGroupWB"
               }
            ]
          }
        },
      "SecurityGroupRDS":{
         "Type":"AWS::EC2::SecurityGroup",
         "Properties":{

            "GroupDescription":"SecurityGroup to access webapplication",
            "SecurityGroupIngress":[

               {
                  "CidrIp":"0.0.0.0/0",
                  "Description":"tcp",
                  "FromPort":"3306",
                  "ToPort":"3306",
                  "IpProtocol":"TCP"
               }
            ],
            "Tags":[
               {
                  "Key":"Name",
                  "Value":"SecurityGroupRDS"
               }
            ]
         }
      },
      "RdsInstance": {
         "Type": "AWS::RDS::DBInstance",
         "Properties": {
            "Engine":  "Postgres",
            "AllocatedStorage": "100",
            "EngineVersion": "10.6",
            "DBInstanceClass": "db.t2.medium",
            "MultiAZ": "false",
            "DBInstanceIdentifier":"csye6225-spring2019",
            "MasterUsername":"csye6225master",
            "MasterUserPassword": "csye6225password" ,
            "PubliclyAccessible": "false",
            "DBName": "csye6225" ,
            "VPCSecurityGroups": [{ "Ref" : "SecurityGroupRDS" }]

         },
         "DeletionPolicy": "Delete"
      }
   }
}
